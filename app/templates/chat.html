<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>AI –ê–≥–µ–Ω—Ç ‚Äî RealtyCalendar</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
<div class="chatbox">
  <div class="messages" id="messages"></div>
  <div class="inputbar">
    <input class="form-control" id="inp" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–æ–ø—Ä–æ—Å‚Ä¶">
    <button class="btn btn-primary" onclick="send()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
  </div>
</div>

<script>
const messages = document.getElementById('messages');
const inp = document.getElementById('inp');

function add(text, who) {
  const div = document.createElement('div');
  div.className = `msg ${who}`;
  div.textContent = text;
  messages.appendChild(div);
  messages.scrollTop = messages.scrollHeight;
}

async function send() {
  const q = inp.value.trim();
  if (!q) return;
  add(q, 'me'); inp.value = '';
  try {
    const res  = await fetch(`/agent/ask?q=${encodeURIComponent(q)}`);
    const data = await res.json();
    add(data.answer || '–ë–æ—Ç –Ω–µ –≤–µ—Ä–Ω—É–ª –æ—Ç–≤–µ—Ç–∞.', 'bot');
  } catch {
    add('–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É', 'bot');
  }
}

window.addEventListener('load', ()=> {
  add('üëã –ü—Ä–∏–≤–µ—Ç! –Ø —Ç–≤–æ–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç RealtyCalendar. –°–ø—Ä–æ—Å–∏ –ø—Ä–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∏–ª–∏ –Ω–∞–ø–∏—à–∏: "–æ–±—ä—è—Å–Ω–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≤ —è—á–µ–π–∫–µ 2".', 'bot');
});

inp.addEventListener('keydown', e=>{
  if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); send(); }
});
</script>
</body>
</html>
